<template>
  <div class="min-h-screen bg-gray-50 py-8">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
      <!-- Header -->
      <div class="text-center mb-8">
        <h1 class="text-3xl font-bold text-gray-900 mb-4">
          ü§ñ AI Communication & Review System Demo
        </h1>
        <p class="text-lg text-gray-600">
          Test all the communication features: AI Chat, Reviews, Multi-channel Messaging
        </p>
      </div>

      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <!-- AI Chat Demo -->
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
          <h2 class="text-xl font-semibold text-gray-900 mb-4">
            ü§ñ AI Chat Assistant
          </h2>
          <div class="space-y-4">
            <p class="text-gray-600">
              The AI chat widget is always available in the bottom-right corner. Try these commands:
            </p>
            <div class="grid grid-cols-1 gap-2">
              <button
                v-for="command in chatCommands"
                :key="command"
                @click="testChatCommand(command)"
                class="text-left bg-blue-50 hover:bg-blue-100 text-blue-800 p-3 rounded-lg transition-colors"
              >
                "{{ command }}"
              </button>
            </div>
            <div class="bg-green-50 border border-green-200 rounded-lg p-4">
              <h4 class="font-medium text-green-900 mb-2">‚úÖ Features Working:</h4>
              <ul class="text-sm text-green-700 space-y-1">
                <li>‚Ä¢ Local command handling (no API needed)</li>
                <li>‚Ä¢ Product recommendations</li>
                <li>‚Ä¢ Cart information</li>
                <li>‚Ä¢ Delivery information</li>
                <li>‚Ä¢ Category browsing</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- Review System Demo -->
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
          <h2 class="text-xl font-semibold text-gray-900 mb-4">
            ‚≠ê Review System
          </h2>
          <div class="space-y-4">
            <p class="text-gray-600">
              Complete review system with post-order email requests:
            </p>
            <div class="space-y-3">
              <div class="bg-blue-50 border border-blue-200 rounded-lg p-3">
                <h4 class="font-medium text-blue-900">üìù Review Components</h4>
                <ul class="text-sm text-blue-700 mt-1">
                  <li>‚Ä¢ ReviewForm.vue - Complete review submission</li>
                  <li>‚Ä¢ ReviewList.vue - Display with filtering</li>
                  <li>‚Ä¢ ReviewWidget.vue - Homepage widget</li>
                </ul>
              </div>
              <div class="bg-green-50 border border-green-200 rounded-lg p-3">
                <h4 class="font-medium text-green-900">üîÑ Automated Flow</h4>
                <ul class="text-sm text-green-700 mt-1">
                  <li>‚Ä¢ Order completion ‚Üí 24h delay ‚Üí Review request</li>
                  <li>‚Ä¢ Email + Telegram/Viber notifications</li>
                  <li>‚Ä¢ Incentivized with 10% discount</li>
                  <li>‚Ä¢ Follow-up reminders</li>
                </ul>
              </div>
              <router-link
                to="/review-order/demo"
                class="inline-block bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg transition-colors"
              >
                Test Review Page
              </router-link>
            </div>
          </div>
        </div>

        <!-- Messaging Demo -->
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
          <h2 class="text-xl font-semibold text-gray-900 mb-4">
            üì± Multi-Channel Messaging
          </h2>
          <div class="space-y-4">
            <p class="text-gray-600">
              Send notifications via multiple channels:
            </p>
            <div class="grid grid-cols-2 gap-3">
              <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 text-center">
                <div class="text-2xl mb-1">üìß</div>
                <div class="text-sm font-medium text-blue-900">Email</div>
                <div class="text-xs text-blue-700">HTML Templates</div>
              </div>
              <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 text-center">
                <div class="text-2xl mb-1">üì±</div>
                <div class="text-sm font-medium text-blue-900">Telegram</div>
                <div class="text-xs text-blue-700">Bot API</div>
              </div>
              <div class="bg-purple-50 border border-purple-200 rounded-lg p-3 text-center">
                <div class="text-2xl mb-1">üíú</div>
                <div class="text-sm font-medium text-purple-900">Viber</div>
                <div class="text-xs text-purple-700">Rich Messages</div>
              </div>
              <div class="bg-green-50 border border-green-200 rounded-lg p-3 text-center">
                <div class="text-2xl mb-1">üí¨</div>
                <div class="text-sm font-medium text-green-900">SMS</div>
                <div class="text-xs text-green-700">Fallback</div>
              </div>
            </div>
            <button
              @click="testMessaging"
              class="w-full bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg transition-colors"
            >
              Test Order Notification
            </button>
          </div>
        </div>

        <!-- Product Recommendations Demo -->
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
          <h2 class="text-xl font-semibold text-gray-900 mb-4">
            üéØ AI Product Recommendations
          </h2>
          <div class="space-y-4">
            <p class="text-gray-600">
              Smart product suggestions based on context:
            </p>
            <div class="space-y-3">
              <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-3">
                <h4 class="font-medium text-yellow-900">üß† AI-Powered</h4>
                <ul class="text-sm text-yellow-700 mt-1">
                  <li>‚Ä¢ OpenAI GPT-4 integration</li>
                  <li>‚Ä¢ Context-aware suggestions</li>
                  <li>‚Ä¢ Natural language reasoning</li>
                </ul>
              </div>
              <div class="bg-blue-50 border border-blue-200 rounded-lg p-3">
                <h4 class="font-medium text-blue-900">üîß Local ML</h4>
                <ul class="text-sm text-blue-700 mt-1">
                  <li>‚Ä¢ Content-based filtering</li>
                  <li>‚Ä¢ Association rules</li>
                  <li>‚Ä¢ Privacy-focused</li>
                </ul>
              </div>
              <div class="grid grid-cols-2 gap-2">
                <router-link
                  to="/cart"
                  class="bg-blue-600 hover:bg-blue-700 text-white text-center font-medium py-2 px-4 rounded-lg transition-colors"
                >
                  Cart Recommendations
                </router-link>
                <router-link
                  to="/shop"
                  class="bg-green-600 hover:bg-green-700 text-white text-center font-medium py-2 px-4 rounded-lg transition-colors"
                >
                  Product Suggestions
                </router-link>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Implementation Status -->
      <div class="mt-8 bg-white rounded-lg shadow-sm border border-gray-200 p-6">
        <h2 class="text-xl font-semibold text-gray-900 mb-4">
          üöÄ Implementation Status
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <div>
            <h3 class="font-medium text-green-900 mb-3">‚úÖ Frontend Complete</h3>
            <ul class="text-sm text-green-700 space-y-1">
              <li>‚Ä¢ AI Chat Widget</li>
              <li>‚Ä¢ Review Components</li>
              <li>‚Ä¢ Messaging Preferences</li>
              <li>‚Ä¢ Product Recommendations</li>
              <li>‚Ä¢ Communication Hub</li>
            </ul>
          </div>
          <div>
            <h3 class="font-medium text-yellow-900 mb-3">‚ö†Ô∏è Backend Needed</h3>
            <ul class="text-sm text-yellow-700 space-y-1">
              <li>‚Ä¢ Review API endpoints</li>
              <li>‚Ä¢ Email service integration</li>
              <li>‚Ä¢ Telegram/Viber bots</li>
              <li>‚Ä¢ Message scheduling</li>
              <li>‚Ä¢ User preferences storage</li>
            </ul>
          </div>
          <div>
            <h3 class="font-medium text-blue-900 mb-3">üîß Configuration</h3>
            <ul class="text-sm text-blue-700 space-y-1">
              <li>‚Ä¢ OpenAI API key</li>
              <li>‚Ä¢ Telegram bot token</li>
              <li>‚Ä¢ Viber bot token</li>
              <li>‚Ä¢ SMTP settings</li>
              <li>‚Ä¢ Webhook endpoints</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- Expected Results -->
      <div class="mt-8 bg-gradient-to-r from-blue-50 to-green-50 border border-blue-200 rounded-lg p-6">
        <h2 class="text-xl font-semibold text-gray-900 mb-4">
          üìä Expected Business Impact
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
          <div class="text-center">
            <div class="text-2xl font-bold text-blue-600">15-25%</div>
            <div class="text-sm text-gray-600">Increase in AOV</div>
          </div>
          <div class="text-center">
            <div class="text-2xl font-bold text-green-600">5-8x</div>
            <div class="text-sm text-gray-600">More Reviews</div>
          </div>
          <div class="text-center">
            <div class="text-2xl font-bold text-purple-600">80%</div>
            <div class="text-sm text-gray-600">Support Automation</div>
          </div>
          <div class="text-center">
            <div class="text-2xl font-bold text-orange-600">60%+</div>
            <div class="text-sm text-gray-600">Message Open Rate</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue'
import { communicationHub } from '@/services/communicationHub'

// Demo data
const chatCommands = [
  '–ü–æ–ø—É–ª—è—Ä–Ω—ñ —Ç–æ–≤–∞—Ä–∏',
  '–ü–æ–∫–∞–∑–∞—Ç–∏ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó',
  '–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –¥–æ—Å—Ç–∞–≤–∫—É',
  '–ö–æ—à–∏–∫',
  '–î–æ–ø–æ–º–æ–≥–∞'
]

// Methods
const testChatCommand = (command: string) => {
  // This would trigger the chat widget to open and send the command
  
  alert(`–°–ø—Ä–æ–±—É–π—Ç–µ –Ω–∞–ø–∏—Å–∞—Ç–∏ "${command}" –≤ —á–∞—Ç-–≤—ñ–¥–∂–µ—Ç—ñ (—Å–∏–Ω—è –∫–Ω–æ–ø–∫–∞ –≤–Ω–∏–∑—É —Å–ø—Ä–∞–≤–∞)`)
}

const testMessaging = async () => {
  // Demo order for testing
  const demoOrder = {
    id: 'demo-123',
    order_number: 'DEMO-001',
    customer_name: '–¢–µ—Å—Ç–æ–≤–∏–π –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á',
    customer_email: 'test@example.com',
    total: 450.00,
    subtotal: 350.00,
    delivery_fee: 99.00,
    delivery_method: 'delivery',
    delivery_address: '–≤—É–ª. –•—Ä–µ—â–∞—Ç–∏–∫, 1, –ö–∏—ó–≤',
    status: 'confirmed',
    created_at: new Date().toISOString(),
    estimated_delivery: new Date(Date.now() + 2 * 60 * 60 * 1000).toISOString(),
    items: [
      { name: '–ü–∏–≤–æ Stella Artois', quantity: 2, price: 75 },
      { name: '–°–∏—Ä –ì–∞—É–¥–∞', quantity: 1, price: 200 }
    ]
  } as any

  try {
    await communicationHub.orderCreated(demoOrder)
    alert('‚úÖ –¢–µ—Å—Ç–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ! –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∫–æ–Ω—Å–æ–ª—å –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.')
  } catch (error) {
    console.error('Messaging test failed:', error)
    alert('‚ö†Ô∏è –¢–µ—Å—Ç –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –ø–æ—Ç—Ä–µ–±—É—î –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è backend API')
  }
}
</script>
